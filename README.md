# فروشگاه کانفیگ V2Ray با پرداخت Plisio و بک‌اند Google Apps Script

این یک پروژه کامل Next.js برای فروش کانفیگ‌های V2Ray است که از Plisio برای پردازش پرداخت با لایت‌کوین (LTC) و از Google Apps Script به عنوان یک بک‌اند ساده برای مدیریت موجودی و ارسال ایمیل استفاده می‌کند.

---

## راهنمای راه‌اندازی (Setup)

برای راه‌اندازی کامل این پروژه، لطفاً مراحل زیر را با دقت دنبال کنید.

### مرحله اول: راه‌اندازی بک‌اند با Google Apps Script

بک‌اند این پروژه یک گوگل شیت (Google Sheet) است که توسط یک اسکریپت (Apps Script) مدیریت می‌شود.

**۱. ایجاد گوگل شیت:**
   - یک [گوگل شیت جدید](https://sheets.new) بسازید.
   - در ردیف اول شیت، **دقیقاً** این سه عنوان را برای ستون‌ها وارد کنید:
     - `productName` (در ستون A)
     - `emailBody` (در ستون B)
     - `priceUSD` (در ستون C)

**۲. وارد کردن داده‌ها:**
   - **productName:** نام محصول خود را وارد کنید (مثلاً `V2Ray Config`). اگر این سلول را خالی بگذارید، از مقدار ردیف بالایی استفاده می‌شود.
   - **emailBody:** کانفیگ V2Ray (یا هر متنی که می‌خواهید برای مشتری ایمیل شود) را در این ستون قرار دهید.
   - **priceUSD:** قیمت محصول را به دلار آمریکا و به صورت عدد (مثلاً `2.5`) وارد کنید.

**۳. ایجاد Google Apps Script:**
   - در منوی بالای گوگل شیت، به `Extensions` > `Apps Script` بروید.
   - تمام محتوای فایل `Code.gs` را پاک کرده و کد نهایی و هماهنگ‌شده را که از من دریافت کرده‌اید در آن کپی کنید.

**۴. تنظیم و پابلیش کردن اسکریپت:**
   - **`SPREADSHEET_ID`:** در بالای کد اسکریپت، مقدار `YOUR_SPREADSHEET_ID` را با ID گوگل شیت خودتان جایگزین کنید. (ID را می‌توانید از URL صفحه شیت کپی کنید).
   - **پابلیش (Deploy):**
     - روی دکمه آبی **Deploy** در بالا سمت راست کلیک کرده و **New deployment** را انتخاب کنید.
     - در پنجره باز شده، روی آیکون چرخ‌دنده کنار "Select type" کلیک کرده و **Web app** را انتخاب کنید.
     - در بخش **Who has access**، گزینه **Anyone** را انتخاب کنید.
     - روی **Deploy** کلیک کنید.
     - در اولین بار، گوگل از شما می‌خواهد که دسترسی‌های لازم (برای مدیریت شیت و ارسال ایمیل) را تایید کنید. روی **Authorize access** کلیک کرده و مراحل را دنبال کنید. (ممکن است یک صفحه هشدار "Google hasn't verified this app" نمایش داده شود که باید روی "Advanced" و سپس "Go to (unsafe)" کلیک کنید).
     - پس از اتمام، یک **Web app URL** به شما داده می‌شود. **این URL را کپی کرده و نگه دارید**. این همان `GOOGLE_APPS_SCRIPT_URL` شماست.

### مرحله دوم: راه‌اندازی پروژه Next.js

**۱. نصب پیش‌نیازها:**
   - [Node.js](https://nodejs.org/) را نصب کنید.

**۲. نصب وابستگی‌های پروژه:**
   - در پوشه اصلی پروژه در ترمینال خود، دستور زیر را اجرا کنید:
     ```bash
     npm install
     ```

**۳. ایجاد فایل متغیرهای محیطی:**
   - در پوشه اصلی پروژه، یک فایل جدید با نام `.env.local` ایجاد کنید.
   - محتوای زیر را در این فایل کپی کرده و مقادیر مربوطه را جایگزین کنید:
     ```
     PLISIO_SECRET_KEY=YOUR_PLISIO_SECRET_KEY
     GOOGLE_APPS_SCRIPT_URL=YOUR_GOOGLE_APPS_SCRIPT_URL
     ```
   - `YOUR_PLISIO_SECRET_KEY`: کلید مخفی API خود را از حساب کاربری Plisio دریافت کنید.
   - `YOUR_GOOGLE_APPS_SCRIPT_URL`: همان URL وب اپی که در مرحله قبل از Apps Script دریافت کردید.

**۴. اجرای پروژه به صورت محلی:**
   - برای اجرای سایت روی کامپیوتر خودتان، دستور زیر را در ترمینال وارد کنید:
     ```bash
     npm run dev
     ```
   - سایت شما در آدرس `http://localhost:9002` در دسترس خواهد بود.

اکنون پروژه شما به طور کامل راه‌اندازی شده و آماده استفاده یا دیپلو در سرویس‌های میزبانی مختلف مانند Vercel یا Netlify است.
